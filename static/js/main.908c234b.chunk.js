(this.webpackJsonpswipeforfuture=this.webpackJsonpswipeforfuture||[]).push([[0],{25:function(e,t,a){e.exports=a(38)},30:function(e,t,a){},32:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(6),o=a.n(i),s=(a(30),a(2)),c=a.n(s),l=a(3),d=a(4),u=a(7),p=a(12),f=a(13),v=a(21),m=a(14),h=a(22),y=a(5),g=a(15),w=function(e,t){Object(n.useEffect)((function(){var a=function(a){e.includes(a.key)&&t(!0,a.key)},n=function(a){e.includes(a.key)&&t(!1,a.key)};return window.addEventListener("keydown",a),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",a),window.removeEventListener("keyup",n)}}))},b={LEFT:-1,RIGHT:1},x=function(e){return{x:0,y:0,scale:1,rot:0,delay:100*e}},E=function(e){return{rot:0,scale:1,y:10}},k=function(e,t){return"perspective(1500px) rotate3d(1, 0, 0, 30deg) rotate3d(0, 0, 1, ".concat(e,"deg) scale(").concat(t,")")},j=function(){return C()/window.devicePixelRatio},C=function(){return Math.min(200,window.innerWidth/2)};var O=function(e){var t=e.i,a=e.cardData,i=e.onSwipe,o=e.layer,s=a.title,c=a.distance,d=a.text,p=a.image,f=Object(y.c)((function(){return Object(u.a)({},x(t),{from:E(t)})})),v=Object(l.a)(f,2),m=v[0],h=v[1],O=Object(n.useState)({isGone:!1,currentKey:null}),I=Object(l.a)(O,1)[0],S=function(e){Object(l.a)(e.args,1)[0];var t=e.down,n=Object(l.a)(e.delta,1)[0],r=(e.distance,Object(l.a)(e.direction,1)[0],e.velocity),o=Math.abs(n)*window.devicePixelRatio>C(),s=Math.sign(n);t||!o||I.isGone||(I.isGone=!0,window.setTimeout((function(){i(a,s),I.currentKey=null}),200));var c=I.isGone,d=c?(200+window.innerWidth)*s:t?n:0;h({x:d,rot:n/100+(c?10*s*r:0),scale:t?1.1:1,delay:void 0,config:{friction:50,tension:t?800:c?200:500}})};w(["ArrowLeft","ArrowRight"],(function(e,t){if(e&&!I.currentKey&&(I.currentKey=t),I.currentKey===t){var a="ArrowLeft"===t?b.LEFT:b.RIGHT;S({down:e,delta:[a*(j()+1),0],direction:[a,0],args:[0],distance:0,velocity:5})}}));var N=Object(g.a)((function(e){I.currentKey||S(e)})),W=m.x,A=m.y,M=m.rot,D=m.scale;return r.a.createElement(y.a.div,{className:"card-container",key:t,style:{position:"absolute",transform:Object(y.b)([W,A],(function(e,t){return"translate3d(".concat(e,"px,").concat(t,"px,0)")})),zIndex:o}},r.a.createElement(y.a.div,Object.assign({className:"card card-front"},N(t),{style:{transform:Object(y.b)([M,D],k)}}),r.a.createElement("div",{className:"card-content"},r.a.createElement("img",{src:p||"",alt:s,style:{width:"100%"}}),r.a.createElement("h2",null,s),r.a.createElement("h5",null,c),r.a.createElement("h5",null,d))))};var I=function(e){var t=e.x,a=e.y,n=e.r,i=void 0===n?0:n,o=e.layer;return r.a.createElement("div",{className:"card-container",style:{position:"absolute",transform:"translate3d(".concat(t,"px, ").concat(a,"px, 0)"),transition:"transform 0.1s",zIndex:o}},r.a.createElement("div",{className:"card card-back",style:{transform:"perspective(1500px) rotate3d(1, 0, 0, 30deg) rotate3d(0, 0, 1, ".concat(i,"deg)"),transition:"transform 0.1s"}},r.a.createElement("div",{className:"card-content"})))};a(32);function S(e,t,a){return(t+e-a%t)%t}var N=function(e){var t=e.onSwipe,a=e.card,n=e.tick,i=void 0===n?0:n,o=Array.apply(null,Array(5)).map((function(e,t){return t}));return r.a.createElement("div",{className:"deck-root"},o.map((function(e,t,a){return r.a.createElement(I,{x:0,y:10+a[S(t,a.length,i)]*(50/a.length),key:t,r:1*Math.sin(2345*e),layer:a.length-S(t,a.length,i)})})),r.a.createElement(O,{i:0,key:a.id,cardData:a,onSwipe:t,layer:o.length+1}))},W=a(19),A=a(18),M=a(20),D=d.a.div.withConfig({displayName:"Bar__Container",componentId:"bgb4rv-0"})(["margin-top:10px;width:40px;height:8px;border-radius:4px;background:#546a76;"]),_=d.a.div.withConfig({displayName:"Bar__Value",componentId:"bgb4rv-1"})(["position:relative;top:1px;left:1px;height:6px;max-width:38px;border-radius:3px;"]);function L(e){return e<=30?"#dd7373":e<=70?"#e7e247":"#91c779"}var F=function(e){var t=e.value,a=void 0===t?100:t;return r.a.createElement(D,null,r.a.createElement(_,{style:{width:"".concat(a,"%"),backgroundColor:L(a)}}))},G=d.a.header.withConfig({displayName:"Stats__Container",componentId:"hfx8u6-0"})(["background:#f6fbf5;display:flex;flex-direction:row;justify-content:space-evenly;align-items:center;"]),R=d.a.div.withConfig({displayName:"Stats__Stat",componentId:"hfx8u6-1"})(["display:flex;justify-content:space-between;align-items:center;flex-direction:column;"]),T=d.a.div.withConfig({displayName:"Stats__Icon",componentId:"hfx8u6-2"})(["width:40px;height:40px;border-radius:50%;background:#91c779;display:flex;justify-content:center;align-items:center;"]);for(var P=function(e){var t=e.stats;return r.a.createElement(G,null,t.map((function(e){var t=A[e.icon]||W[e.icon]||M[e.icon],a=e.iconSize||"80%",n=e.value;return r.a.createElement(R,{key:e.id},r.a.createElement(T,null,t&&r.a.createElement(t,{size:a})),r.a.createElement(F,{value:n}))})))},Q=d.a.footer.withConfig({displayName:"Game__Footer",componentId:"lrnx5z-0"})(["display:flex;justify-content:center;align-items:center;"]),z=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(v.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state=a.getInitialState(),a}return Object(h.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.addUniqueCardId(this.state.card),t=this.state.world.state,a=this.props.worldData.stats.map((function(e){return Object.assign({},e,{value:t[e.id]})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{stats:a}),r.a.createElement(N,{onSwipe:this.onSwipe.bind(this),card:e,tick:this.state.rounds}),r.a.createElement(Q,null,r.a.createElement("div",{className:"time-remaining"})))}},{key:"getInitialState",value:function(){var e=this.props.worldData.defaultState;return{world:e,card:this.getInitialCard(e),rounds:0}}},{key:"getInitialCard",value:function(e){var t=this.getAvailableEvents(e),a=this.selectNextEvent(t);return a?this.selectEventCard(a.initialEventCardId):this.selectNextCard(this.getAvailableCards(this.props.worldData.defaultState))}},{key:"getAvailableCards",value:function(e){var t=this;return this.props.worldData.cards.filter((function(a){return t.hasMatchingWorldQuery(e,a.isAvailableWhen)}))}},{key:"getAvailableEvents",value:function(e){var t=this;return this.props.worldData.events.filter((function(a){return t.hasMatchingWorldQuery(e,a.shouldTriggerWhen)}))}},{key:"hasMatchingWorldQuery",value:function(e,t){var a=this;return t.some((function(t){return a.isMatchingWorldQuery(e,t)}))}},{key:"isMatchingWorldQuery",value:function(e,t){var a=t.state,n=void 0===a?{}:a,r=t.flags,i=void 0===r?{}:r;return Object.entries(n).every((function(t){var a=Object(l.a)(t,2),n=a[0],r=Object(l.a)(a[1],2),i=r[0],o=r[1];return e.state[n]>=i&&e.state[n]<=o}))&&Object.entries(i).every((function(t){var a=Object(l.a)(t,2),n=a[0],r=a[1];return e.flags[n]===r}))}},{key:"onSwipe",value:function(e,t){var a=t===b.LEFT?e.actions.left:e.actions.right,n=this.getUpdatedWorld(a.modifier);this.setState({world:n,card:this.getNextCard(n,e,a),rounds:this.state.rounds+1})}},{key:"getNextCard",value:function(e,t,a){var n,r=this.props.worldData.eventCards,i=this.getAvailableEvents(e),o="event"!==t.type?this.selectNextEvent(i):null;if("event"===t.type&&"string"===typeof a.nextEventCardId){if(!r.hasOwnProperty(a.nextEventCardId))throw new Error('eventCardId "'.concat(a.nextEventCardId,"\" does not exist. Make sure it's spelled correctly"));n=this.selectEventCard(a.nextEventCardId)}else if(o)n=this.selectEventCard(o.initialEventCardId);else{var s=this.getAvailableCards(e);n=this.selectNextCard(s)}return n}},{key:"getUpdatedWorld",value:function(e){var t=e.type,a=void 0===t?"add":t,n=e.state,r=void 0===n?{}:n,i=e.flags,o={type:a,state:r,flags:void 0===i?{}:i};return{state:this.updateWorldState(o),flags:this.updateWorldFlags(o)}}},{key:"updateWorldState",value:function(e){var t="replace"===e.type?Object.assign({},this.props.worldData.defaultState.state):Object.assign({},this.state.world.state);return Object.entries(e.state).reduce((function(t,a){var n=Object(l.a)(a,2),r=n[0],i=n[1],o="set"===e.type||"replace"===e.type?i:i+(t[r]||0);return t[r]=Math.min(Math.max(o,0),100),t}),t)}},{key:"updateWorldFlags",value:function(e){var t="replace"===e.type?Object.assign({},this.props.worldData.flags):Object.assign({},this.state.world.flags);return Object.keys(e.flags).reduce((function(t,a){return t[a]=e.flags[a],t}),t)}},{key:"addUniqueCardId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(u.a)({},e,{id:Date.now()+":"+t})}},{key:"selectNextCard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.selectRandomFrom(e)}},{key:"selectNextEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.selectRandomFrom(e);if(t&&Math.random()<t.probability)return t}},{key:"selectRandomFrom",value:function(e){return e[Math.floor(Math.random()*e.length)]}},{key:"selectEventCard",value:function(e){return this.props.worldData.eventCards[e]}}]),t}(n.Component),B={"end-game":{image:"https://images.unsplash.com/photo-1497039465987-61d305728610?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=800&q=60",title:"The World Has Ended.",distance:"100 miles away",text:"Please find a new planet to destroy, if you want to proceed. And do not try to swipe. Please.",weight:1e3,actions:{left:{modifier:{type:"replace",state:{environment:10,people:10,security:10},flags:{}},nextEventCardId:null},right:{modifier:{type:"replace",state:{environment:10,people:10,security:10},flags:{}},nextEventCardId:null}}}},H=0,J=Object.keys(B);H<J.length;H++){B[J[H]].type="event"}var K=Object.freeze({state:{environment:40,people:60,security:75,money:90},flags:{}}),q=[{id:"environment",name:"Environment",icon:"GiWheat"},{id:"people",name:"People",icon:"IoIosPeople"},{id:"security",name:"Security",icon:"GiAk47"},{id:"money",name:"Money",icon:"GiMoneyStack"}],U={stats:q,cards:[{image:"https://images.unsplash.com/photo-1561623002-b3520705eccf?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=800&q=60",title:"We need power.",distance:"4 miles away",text:"Lorem ipsum COALar sit amet consectetur, adipisicing elit.",weight:1,isAvailableWhen:[{state:{environment:[10,100],money:[80,100]}},{state:{people:[10,100],money:[80,100]}},{state:{security:[10,100],money:[80,100]}}],actions:{left:{modifier:{type:"add",state:{environment:-100,people:-100,security:-100,money:-100}}},right:{modifier:{type:"add",state:{environment:40,people:60,security:75,money:90}}}}},{image:"https://images.unsplash.com/photo-1497435334941-8c899ee9e8e9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=800&q=60",title:"Invest in solar?",distance:"100 miles away",text:"Lorem ipsum SOLAR sit amet consectetur, adipisicing elit.",weight:1,isAvailableWhen:[{state:{environment:[60,100],money:[30,31]}},{state:{people:[60,100],money:[30,31]}},{state:{security:[60,100],money:[30,31]}}],actions:{left:{modifier:{type:"add",state:{environment:-100,people:-100,security:-100,money:-100}}},right:{modifier:{type:"add",state:{environment:40,people:60,security:75,money:90}}}}}],events:[{probability:1,shouldTriggerWhen:[{state:{environment:[0,0]}},{state:{security:[0,0]}},{state:{money:[0,0]}},{state:{people:[0,0]}}],initialEventCardId:"end-game"}],eventCards:B,defaultState:K},V={default:U};function X(e){var t,a,n,r,i;return c.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(t=e.match(/^local:\/\/(.*)/))){o.next=16;break}if(a=t[1],n="game_world:"+a,r={},o.prev=5,i=JSON.parse(localStorage.getItem(n))){o.next=9;break}throw new Error("Could not load data from local storage: "+n);case 9:r=i||{},o.next=15;break;case 12:o.prev=12,o.t0=o.catch(5),console.log(o.t0);case 15:return o.abrupt("return",Object.assign({},U,r));case 16:return o.abrupt("return",null);case 17:case"end":return o.stop()}}),null,null,[[5,12]])}function Y(e){var t,a,n;return c.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(t=e.match(/^internal:\/\/(.*)/))){r.next=8;break}if(a=t[1],n=V[a]){r.next=7;break}return console.warn("Could not load local game world: ",a),r.abrupt("return",U);case 7:return r.abrupt("return",n);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}))}function Z(e){var t,a,n,r,i,o,s,l,d,u;return c.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e+"/stats.json",a=e+"/cards.json",n=e+"/events.json",r=e+"/event-cards.json",i=e+"/default-state.json",p.next=7,c.a.awrap(ee(t,q));case 7:return o=p.sent,p.next=10,c.a.awrap(ee(a,[]));case 10:return s=p.sent,p.next=13,c.a.awrap(ee(n,[]));case 13:return l=p.sent,p.next=16,c.a.awrap(ee(r,{}));case 16:return d=p.sent,p.next=19,c.a.awrap(ee(i,K));case 19:return u=p.sent,p.abrupt("return",{stats:o,cards:s,events:l,eventCards:d,defaultState:u});case 21:case"end":return p.stop()}}))}function $(e){return c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.awrap(Y(e));case 2:if(t.t1=t.sent,t.t1){t.next=7;break}return t.next=6,c.a.awrap(X(e));case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=12;break}return t.next=11,c.a.awrap(Z(e));case 11:t.t0=t.sent;case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}))}function ee(e,t){return c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,console.log("fetching path: ",e),a.t0=c.a,a.next=5,c.a.awrap(window.fetch(e));case 5:return a.t1=a.sent.json(),a.next=8,a.t0.awrap.call(a.t0,a.t1);case 8:return a.abrupt("return",a.sent);case 11:return a.prev=11,a.t2=a.catch(0),console.warn("Could not load path: "+e),a.abrupt("return",t);case 15:case"end":return a.stop()}}),null,null,[[0,11]])}var te=d.a.main.withConfig({displayName:"App__Container",componentId:"sc-9rzb8l-0"})(["position:absolute;top:0;left:0;width:100vw;height:100%;background:#546a76;display:grid;grid-template-rows:minmax(50px,80px) auto minmax(50px,80px);"]);var ae=function(e){var t=e.path,a=Object(n.useState)(null),i=Object(l.a)(a,2),o=i[0],s=i[1];return Object(n.useEffect)((function(){!function(){var e;c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.a.awrap($(t));case 2:e=a.sent,s(e);case 4:case"end":return a.stop()}}))}()}),[t,s]),r.a.createElement(te,null,o&&r.a.createElement(z,{worldData:o}))},ne=new URLSearchParams(window.location.search).get("path")||"/data/default";o.a.render(r.a.createElement(ae,{path:ne}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.908c234b.chunk.js.map